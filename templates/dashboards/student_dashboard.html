{% extends "base.html" %}

{% block title %}Student Dashboard — Victoria University{% endblock %}

{% block content %}
<div class="row g-4">
  <!-- MAIN -->
  <div class="col-12 col-lg-8">
    <div class="card">
      <div class="card-header d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-2">
        <div>
          <div class="fw-bold">Student Dashboard</div>
          <div class="text-muted small">Manage your internship process at Victoria University</div>
        </div>

        <span class="badge text-bg-light border">
          <i class="bi bi-person-check me-1"></i> Student
        </span>
      </div>

      <div class="card-body">
        <!-- Welcome strip -->
        <div class="p-3 p-md-4 border rounded-4 bg-white">
          <div class="d-flex align-items-start gap-3">
            <i class="bi bi-mortarboard-fill text-danger fs-3"></i>

            <div class="w-100">
              <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2">
                <div>
                  <div class="fw-bold mb-1">
                    Welcome, <span class="text-danger">{{ request.user.display_name }}</span>
                  </div>
                  <div class="text-muted">
                    Use the quick actions below to submit requests, upload letters, and manage weekly logs.
                  </div>
                </div>

                {% if placement %}
                  <span class="badge text-bg-light border">
                    <i class="bi bi-briefcase me-1"></i>
                    Placement: {{ placement.status|title }}
                  </span>
                {% else %}
                  <span class="badge text-bg-warning">
                    <i class="bi bi-exclamation-triangle me-1"></i>
                    No placement yet
                  </span>
                {% endif %}
              </div>

              {% if placement and placement.company %}
                <div class="small text-muted mt-2">
                  <i class="bi bi-building me-1"></i> {{ placement.company.name }}
                  {% if placement.university_supervisor %}
                    <span class="mx-2">•</span>
                    <i class="bi bi-person-badge me-1"></i> University Supervisor Assigned
                  {% endif %}
                </div>
              {% endif %}
            </div>
          </div>
        </div>

        <hr class="my-4"/>

        <!-- Quick actions -->
        <div class="row g-3">
          <!-- Submit Request -->
          <div class="col-12 col-md-6">
            <a href="{% url 'submit_request' %}" class="text-decoration-none">
              <div class="p-3 border rounded-4 h-100 hover-shadow">
                <div class="d-flex align-items-center gap-2 mb-1">
                  <i class="bi bi-file-earmark-text text-danger"></i>
                  <div class="fw-bold">Submit Internship Request</div>
                </div>
                <div class="text-muted small">
                  Fill your internship request form and submit to the coordinator.
                </div>
              </div>
            </a>
          </div>

          <!-- Upload Acceptance -->
          <div class="col-12 col-md-6">
            <a href="{% url 'student_upload_acceptance' %}" class="text-decoration-none">
              <div class="p-3 border rounded-4 h-100">
                <div class="d-flex align-items-center gap-2 mb-1">
                  <i class="bi bi-cloud-upload text-danger"></i>
                  <div class="fw-bold">Upload Acceptance Letter</div>
                </div>
                <div class="text-muted small">
                  After receiving the company acceptance letter, upload it here.
                </div>
              </div>
            </a>
          </div>

          <!-- Weekly Logs -->
          <div class="col-12 col-md-6">
            <a href="{% url 'student_logs' %}" class="text-decoration-none">
              <div class="p-3 border rounded-4 h-100">
                <div class="d-flex align-items-center gap-2 mb-1">
                  <i class="bi bi-journal-check text-danger"></i>
                  <div class="fw-bold">Weekly Logs</div>
                </div>
                <div class="text-muted small">
                  View your weekly logs and track approvals.
                </div>
              </div>
            </a>
          </div>

          <!-- Add New Log -->
          <div class="col-12 col-md-6">
            <a href="{% url 'student_log_new' %}" class="text-decoration-none">
              <div class="p-3 border rounded-4 h-100">
                <div class="d-flex align-items-center gap-2 mb-1">
                  <i class="bi bi-plus-circle text-danger"></i>
                  <div class="fw-bold">Add New Weekly Log</div>
                </div>
                <div class="text-muted small">
                  Create a new weekly log entry, then submit it for approval.
                </div>
              </div>
            </a>
          </div>

          <!-- Student Evaluation Form -->
          <div class="col-12">
            <div class="p-3 border rounded-4 bg-light">
              <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-2">
                <div>
                  <div class="fw-bold mb-1">
                    <i class="bi bi-ui-checks text-danger me-1"></i> Student Evaluation Form
                  </div>
                  <div class="small text-muted">
                    Complete this at the end of internship to help improve the program for future interns.
                  </div>
                </div>

                <div>
                  {% if placement and placement.status == "active" %}
                    <a class="btn btn-outline-primary"
                       href="{% url 'student_evaluation_form' %}">
                      Fill Form
                    </a>
                  {% else %}
                    <button class="btn btn-outline-secondary" disabled>
                      <i class="bi bi-lock me-1"></i> Requires Active Placement
                    </button>
                  {% endif %}
                </div>
              </div>

              {% if not placement %}
                <div class="small text-muted mt-2">
                  Tip: Once your placement is activated by the coordinator, this form will unlock.
                </div>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Info box -->
        <div class="mt-4 p-3 rounded-4 border bg-white">
          <div class="d-flex align-items-start gap-2">
            <i class="bi bi-info-circle text-danger fs-5"></i>
            <div class="small text-muted">
              <div class="fw-semibold text-dark mb-1">How approvals work</div>
              Your industry supervisor approves your logs first. After approval, your university supervisor can review and plan site visits.
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="col-12 col-lg-4">
    <!-- Summary -->
    <div class="card">
      <div class="card-header fw-bold">
        <i class="bi bi-clipboard-data me-1"></i> Summary
      </div>

      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <span class="text-muted">Placement</span>
          {% if placement %}
            {% if placement.status == "active" %}
              <span class="badge text-bg-success">Active</span>
            {% elif placement.status == "pending" %}
              <span class="badge text-bg-warning">Pending</span>
            {% else %}
              <span class="badge text-bg-secondary">{{ placement.status }}</span>
            {% endif %}
          {% else %}
            <span class="badge text-bg-secondary">Not yet</span>
          {% endif %}
        </div>

        <div class="d-flex align-items-center justify-content-between mb-2">
          <span class="text-muted">Acceptance Letter</span>
          <span class="badge text-bg-light border">Check upload</span>
        </div>

        <div class="d-flex align-items-center justify-content-between mb-2">
          <span class="text-muted">Weekly Logs</span>
          <a class="badge text-bg-primary text-decoration-none" href="{% url 'student_logs' %}">View</a>
        </div>

        <div class="d-flex align-items-center justify-content-between">
          <span class="text-muted">Evaluation Form</span>
          {% if placement and placement.status == "active" %}
            <span class="badge text-bg-success">Available</span>
          {% else %}
            <span class="badge text-bg-secondary">Locked</span>
          {% endif %}
        </div>

        <hr class="my-3"/>

        <div class="small text-muted">
          Tip: Submit your weekly logs on time to avoid delays in approvals.
        </div>
      </div>
    </div>

    <!-- Next steps -->
    <div class="card mt-4">
      <div class="card-header fw-bold">
        <i class="bi bi-lightbulb me-1"></i> Next Steps
      </div>
      <div class="card-body">
        <ol class="small mb-0">
          <li>Submit internship request.</li>
          <li>Upload your company acceptance letter.</li>
          <li>Create weekly logs and submit for approval.</li>
          <li>Follow up when supervisor is allocated.</li>
          <li>Complete student evaluation form at the end.</li>
        </ol>
      </div>
    </div>

  </div>
</div>
{% endblock %}
